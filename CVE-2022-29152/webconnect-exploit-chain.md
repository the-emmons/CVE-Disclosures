The Ericom portal responses contain the header 'Access-Control-Allow-Origin: *' by default. Because of that, Ajax cross-domain requests cannot tie an XSS payload to a persisted unauthenticated session cookie. To work around that limitation, the following exploit chain can be used to set a cookie on a victim domain from an attacker domain, then leverage reflected XSS to store a keylogger and capture portal credentials.

# Ericom attack chain

**Page this takes place on:Â https://attacker.com/evil**

1.  Victim visits attacker's page.
2.  Attacker site auto-launches a POST request login attempt to the portal with the username value set to a "dropper" XSS payload.

**Page this takes place on: [https://webconnect.friendlycorp.com/WebConnect/AppPortal/sgIndex.asp](https://vpn.friendlycorp.com/WebConnect/AppPortal/sgIndex.asp)**

1.  Portal login attempt fails and the 'User' field, containing the XSS dropper, is set as a cookie and then written unsafely back into the page source.
2.  Dropper executes on victim domain.
3.  Dropper wipes the AppPortal cookie (containing the initial dropper payload).
4.  Dropper sets an AppPortal cookie on the same domain containing a new keylogger Javascript payload.
5.  The original dropper, no longer set as a cookie but still running in the page, navigates back to the attacker's site.

The next time the victim user uses the login page, even if it's a week or two later, their plaintext Active Directory credentials will be stolen by the keylogger payload and sent to the attacker.
